<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Qosyl Messenger</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #ece5dd;
    }
    .container {
      display: none;
      flex-direction: column;
      height: 100vh;
    }
    .header {
      background: #075E54;
      color: white;
      padding: 15px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .chat-box {
      flex: 1;
      padding: 10px;
      overflow-y: auto;
      background: #fff;
    }
    .input-area {
      display: flex;
      padding: 10px;
      background: #f0f0f0;
    }
    .input-area input {
      flex: 1;
      padding: 10px;
      border-radius: 20px;
      border: 1px solid #ccc;
      outline: none;
    }

    /* –û–±—â–∏–π —Å—Ç–∏–ª—å –∫–Ω–æ–ø–æ–∫ */
    button {
      cursor: pointer;
      transition: background 0.3s ease;
    }
    button:hover {
      opacity: 0.9;
    }

    /* –ö–Ω–æ–ø–∫–∞ "+" –¥–ª—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ */
    #newContactBtn {
      background: #25D366;
      color: white;
      font-size: 20px;
      border: none;
      border-radius: 50%;
      width: 35px;
      height: 35px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è üì® */
    .send-btn {
      background: #25D366;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-size: 18px;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-left: 5px;
    }

    /* –ö–Ω–æ–ø–∫–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ üé§ */
    .mic-btn {
      background: none;
      border: 2px solid #25D366;
      color: #25D366;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-left: 5px;
    }

    /* –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ */
    .back-btn {
      background: none;
      border: none;
      cursor: pointer;
      color: white;
      font-size: 20px;
    }

    /* –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –º–µ–Ω—é */
    .contact-item {
      padding: 12px;
      border-bottom: 1px solid #ddd;
      cursor: pointer;
    }
    .contact-item:hover {
      background: #f5f5f5;
    }

    /* –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ ‚öôÔ∏è */
    .settings-btn {
      background: #075E54;
      color: white;
      border: none;
      border-radius: 0;
      font-size: 18px;
      padding: 12px;
    }
    .settings-btn:hover {
      background: #064c44;
    }
  </style>
</head>
<body>

<!-- –ê–Ω–∫–µ—Ç–∞ –≤—Ö–æ–¥–∞ -->
<div id="loginContainer" class="container" style="display:flex;">
  <div class="header">
    <span>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Qosyl</span>
  </div>
  <div class="chat-box">
    <label>–í–∞—à –Ω–æ–º–µ—Ä:</label><br>
    <input type="text" id="userNumber"><br><br>
    <label>–í–∞—à–µ –∏–º—è:</label><br>
    <input type="text" id="userName"><br><br>
    <label>–ì–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è:</label><br>
    <input type="number" id="userYear"><br><br>
    <button onclick="login()" style="background:#25D366;color:white;border-radius:20px;padding:10px 20px;">–í–æ–π—Ç–∏</button>
  </div>
</div>

<!-- –û–∫–Ω–æ: –ß–∞—Ç—ã -->
<div id="chatsContainer" class="container">
  <div class="header">
    <span style="font-weight:bold;font-size:20px;">–ß–∞—Ç—ã</span>
    <button id="newContactBtn" onclick="openContacts()">+</button>
  </div>
  <div id="chatsList" class="chat-box"></div>
  <button onclick="openSettings()" class="settings-btn">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
</div>

<!-- –û–∫–Ω–æ: –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
<div id="contactsContainer" class="container">
  <div class="header">
    <button onclick="backToChats()" class="back-btn">‚Üê</button>
    <span>–ù–æ–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç</span>
  </div>
  <div class="chat-box">
    <label>–ò–º—è:</label><br>
    <input type="text" id="contactName"><br><br>
    <label>–ù–æ–º–µ—Ä:</label><br>
    <input type="text" id="contactNumber"><br><br>
    <button onclick="saveContact()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
  </div>
</div>

<!-- –û–∫–Ω–æ: –ß–∞—Ç -->
<div id="chatContainer" class="container">
  <div class="header">
    <button onclick="backToChats()" class="back-btn">‚Üê</button>
    <span id="chatWith"></span>
  </div>
  <div id="messages" class="chat-box"></div>
  <div class="input-area">
    <input type="text" id="messageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
    <button class="send-btn" onclick="sendMessage()">üì®</button>
    <button class="mic-btn" onclick="sendAudio()">üé§</button>
  </div>
</div>

<!-- –û–∫–Ω–æ: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
<div id="settingsContainer" class="container">
  <div class="header">
    <button onclick="backToChats()" class="back-btn">‚Üê</button>
    <span style="font-weight:bold;font-size:20px;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
  </div>
  <div id="settingsMenu" class="chat-box">
    <div class="contact-item" onclick="openProfile()">üßë –ü—Ä–æ—Ñ–∏–ª—å</div>
    <div class="contact-item">üí¨ –ß–∞—Ç—ã</div>
    <div class="contact-item">üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
    <div class="contact-item">‚ÑπÔ∏è –û –ø—Ä–æ–≥—Ä–∞–º–º–µ</div>
    <div class="contact-item">üîí –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</div>
    <div class="contact-item" onclick="logout()">üö™ –í—ã–π—Ç–∏</div>
  </div>
</div>

<script>
let contacts = [];
let currentChat = null;

function login() {
  let number = document.getElementById("userNumber").value;
  let name = document.getElementById("userName").value;
  let year = document.getElementById("userYear").value;
  if (!number || !name) {
    alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!");
    return;
  }
  localStorage.setItem("user", JSON.stringify({number, name, year}));
  document.getElementById("loginContainer").style.display = "none";
  document.getElementById("chatsContainer").style.display = "flex";
}

function openContacts() {
  document.getElementById("chatsContainer").style.display = "none";
  document.getElementById("contactsContainer").style.display = "flex";
}

function backToChats() {
  document.getElementById("contactsContainer").style.display = "none";
  document.getElementById("chatContainer").style.display = "none";
  document.getElementById("settingsContainer").style.display = "none";
  document.getElementById("chatsContainer").style.display = "flex";
  loadChats();
}

function saveContact() {
  let name = document.getElementById("contactName").value;
  let number = document.getElementById("contactNumber").value;
  if (!name || !number) {
    alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ –Ω–æ–º–µ—Ä!");
    return;
  }
  contacts.push({name, number, messages: []});
  document.getElementById("contactName").value = "";
  document.getElementById("contactNumber").value = "";
  backToChats();
}

function loadChats() {
  let list = document.getElementById("chatsList");
  list.innerHTML = "";
  contacts.forEach((c, i) => {
    let div = document.createElement("div");
    div.className = "contact-item";
    div.innerText = c.name + " (" + c.number + ")";
    div.onclick = () => openChat(i);
    list.appendChild(div);
  });
}

function openChat(i) {
  currentChat = i;
  document.getElementById("chatsContainer").style.display = "none";
  document.getElementById("chatContainer").style.display = "flex";
  document.getElementById("chatWith").innerText = contacts[i].name;
  loadMessages();
}

function loadMessages() {
  let box = document.getElementById("messages");
  box.innerHTML = "";
  contacts[currentChat].messages.forEach(m => {
    let div = document.createElement("div");
    div.innerText = m;
    box.appendChild(div);
  });
}

function sendMessage() {
  let text = document.getElementById("messageInput").value;
  if (text.trim() === "") return;
  contacts[currentChat].messages.push("–í—ã: " + text);
  document.getElementById("messageInput").value = "";
  loadMessages();
}

function sendAudio() {
  contacts[currentChat].messages.push("üé§ –ì–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ");
  loadMessages();
}

function openSettings() {
  document.getElementById("chatsContainer").style.display = "none";
  document.getElementById("settingsContainer").style.display = "flex";
}

function logout() {
  if (confirm("–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞?")) {
    localStorage.clear();
    contacts = [];
    location.reload();
  }
}

function openProfile() {
  let user = JSON.parse(localStorage.getItem("user"));
  alert("–ò–º—è: " + user.name + "\n–ù–æ–º–µ—Ä: " + user.number + "\n–ì–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è: " + user.year);
}
</script>
</body>
</html>
